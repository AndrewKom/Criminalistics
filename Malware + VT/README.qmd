---
title: "Malware + VT" 
format:   
  md:     
    output-file: README.md 
editor: visual 
---

# Статический анализ вредоносных программ

Были получены 4 подозрительных приложения, которые необходимо проанализировать и понять какую полезную нагрузку они могут в себя включать. Также в ходе работы будет затронута служба VirusTotal.

VirusTotal — бесплатная служба, осуществляющая анализ подозрительных файлов и ссылок (URL) на предмет выявления вирусов, червей, троянов и всевозможных вредоносных программ.

## Анализ программ

### Lab01-01.exe и Lab01-01.dll

По отчету с VirusTotal можно утверждать, что данные программы несут в себе полезную нагрузку, которая может угрожать устройству.

![![](images/clipboard-1593406008.png)](images/clipboard-1593406008.png)

Чтобы посмотреть даты компиляции программ можно использовать утилиту PEview. Для этого необходимо посмотреть значение поля TimeDateStamp в файловом заголовке IMAGE_FILE_HEADER.

![](images/clipboard-1962978108.png)

![](images/clipboard-1034475775.png)

С использованием утилиты PEiD выполним сканирование исполняемых файлов. Утилита PEiD обнаружила сигнатуру стандартного компилятора фирмы Microsoft, что говорит об отсутствии изменений возле точки входа в программу.

![](images/clipboard-2624006483.png)

![](images/clipboard-511911600.png)

Затем можно проверить поля размеров секции в памяти и на диске. Размеры секции кода на диске и в памяти практически одинаковые, что также говорит об отсутствии следов обфускации.

![](images/clipboard-2988566532.png)

Следующим шагом может стать проверка строк с исполняемых файлах. Для этого можно воспользоваться утилитой strings из пакета Malcode Analyst Pack. Строки в исполняемых файлах присутствуют в явном виде, что говорит об отсутствии следов обфускации или упаковки.

![](images/clipboard-3954760161.png)

Для анализа исполняемых функций можно воспользоваться утилитой Dependency Walker. Она показывает все используемые библиотеки и импортируемые из них функции. В первом файле присутствуют функции CopyFile, FindFirstFile, FindNextFile. Это говорит о том, что скорее всего программа ищет какой-то файл и затем копирует его. Во втором файле находятся функции CreateProcess, Sleep. Основываясь на этом, можно сделать вывод, что исследуемая DLL, скорее всего создаст новый процесс и на каком-то этапе заснет (приостановит выполнение). В DLL также присутствуют интересные импортируемые функции из библиотеки WS2_32.DLL, которые импортируются по порядковому номеру. К интересным функциям из библиотеки WS2_32.DLL можно отнести: closesocket, connect, htons, inet_addr, recv, send, shutdown, socket, WSAStartup, WSACleanup. Эти функции говорят о том, что программа выполняет интернет соединение и передает данные на удаленный IP-адрес.

### Lab01-02.exe

### Lab01-03.exe

### Lab01-04.exe
